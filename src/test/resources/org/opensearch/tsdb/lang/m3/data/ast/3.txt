ROOT
  PIPELINE
    PIPELINE
      GROUP
        FUNCTION(fetch)
          TAG_KEY(region)
            TAG_VALUE(west)
        FUNCTION(sum)
          VALUE(city_name)
        FUNCTION(transformNull)
        FUNCTION(moving)
          VALUE(1h)
          VALUE(sum)
    FUNCTION(asPercent)
      PIPELINE
        GROUP
          PIPELINE
            GROUP
              FUNCTION(fetch)
                TAG_KEY(region)
                  TAG_VALUE(west)
              FUNCTION(sum)
                VALUE(city_name)
              FUNCTION(transformNull)
              FUNCTION(moving)
                VALUE(1h)
                VALUE(sum)
          PIPELINE
            GROUP
              PIPELINE
                GROUP
                  FUNCTION(fetch)
                    TAG_KEY(region)
                      TAG_VALUE(west)
                  FUNCTION(sum)
                    VALUE(city_name)
                  FUNCTION(transformNull)
                  FUNCTION(moving)
                    VALUE(1h)
                    VALUE(sum)
              FUNCTION(timeshift)
                VALUE(1d)
          PIPELINE
            GROUP
              PIPELINE
                GROUP
                  FUNCTION(fetch)
                    TAG_KEY(region)
                      TAG_VALUE(west)
                  FUNCTION(sum)
                    VALUE(city_name)
                  FUNCTION(transformNull)
                  FUNCTION(moving)
                    VALUE(1h)
                    VALUE(sum)
              FUNCTION(timeshift)
                VALUE(2d)
          FUNCTION(avg)
    FUNCTION(transformNull)
    FUNCTION(moving)
      VALUE(1h)
      VALUE(avg)
